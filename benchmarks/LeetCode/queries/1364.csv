10,"select a.invoice_id, b.customer_name, a.price, count(c.user_id) as contacts_cnt, count(d.customer_name) as trusted_contacts_cnt from invoices as a left outer join customers as b on a.user_id = b.customer_id left outer join contacts as c on b.customer_id = c.user_id left outer join customers as d on d.customer_name = c.contact_name group by a.invoice_id, b.customer_name, a.price order by a.invoice_id"
15,"select i.invoice_id, c1.customer_name, i.price, count(m.contact_email) as contacts_cnt, count(c2.email) as trusted_contacts_cnt from invoices as i left outer join customers as c1 on i.user_id = c1.customer_id left outer join contacts as m on c1.customer_id = m.user_id left outer join customers as c2 on (m.contact_name = c2.customer_name and m.contact_email = c2.email) group by i.invoice_id, c1.customer_name, i.price order by i.invoice_id"
43,"select i.invoice_id, us.customer_name, i.price, count(co.contact_name) as contacts_cnt, count(cu.customer_name) as trusted_contacts_cnt from invoices as i left outer join contacts as co on i.user_id = co.user_id left outer join customers as cu on co.contact_name = cu.customer_name left outer join customers as us on us.customer_id = i.user_id group by 1, 2, 3 order by i.invoice_id"
135,"select c.invoice_id, a.customer_name, c.price, count(b.contact_name) as contacts_cnt, count(distinct d.customer_name) as trusted_contacts_cnt from invoices as c left outer join customers as a on a.customer_id = c.user_id left outer join contacts as b on a.customer_id = b.user_id left outer join customers as d on b.contact_name = d.customer_name group by 1, 2, 3"
188,"select i.invoice_id, min(cu.customer_name) as customer_name, min(i.price) as price, count(c.contact_name) as contacts_cnt, count(cu2.email) as trusted_contacts_cnt from invoices as i left outer join customers as cu on i.user_id = cu.customer_id left outer join contacts as c on i.user_id = c.user_id left outer join customers as cu2 on c.contact_name = cu2.customer_name group by i.invoice_id order by i.invoice_id"
204,"select invoice_id, c.customer_name, price, count(o.contact_name) as contacts_cnt, count(a.email) as trusted_contacts_cnt from invoices as i left outer join customers as c on i.user_id = c.customer_id left outer join contacts as o on c.customer_id = o.user_id left outer join customers as a on a.email = o.contact_email group by i.invoice_id, c.customer_name, i.price order by i.invoice_id"
228,"select invoice_id, t2.customer_name, price, count(distinct t3.contact_name) as contacts_cnt, count(distinct t4.customer_name) as trusted_contacts_cnt from invoices as t1 left outer join customers as t2 on t1.user_id = t2.customer_id left outer join contacts as t3 on t1.user_id = t3.user_id left outer join customers as t4 on t3.contact_name = t4.customer_name group by 1, 2, 3"
233,"select invoices.invoice_id, customers.customer_name, invoices.price, count(contact_name) as contacts_cnt, count(emails.email) as trusted_contacts_cnt from invoices as invoices left outer join customers as customers on invoices.user_id = customers.customer_id left outer join contacts as contacts on invoices.user_id = contacts.user_id left outer join customers as emails on emails.email = contacts.contact_email group by invoices.invoice_id, invoices.price, customers.customer_name order by invoice_id"
