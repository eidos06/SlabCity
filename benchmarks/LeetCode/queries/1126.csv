1,"select distinct events.business_id from events join (select event_type, avg(occurences) as mean from events group by event_type) as t on (t.event_type = events.event_type and occurences > mean) group by business_id having count(business_id) > 1"
2,"select distinct a.business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as mean from events) as a where a.occurences > a.mean group by a.business_id having count(distinct a.event_type) > 1"
6,"select distinct business_id from events as a join (select event_type, avg(occurences) as avg_occur from events group by event_type) as b on (a.event_type = b.event_type and a.occurences > b.avg_occur) group by a.business_id having count(a.event_type) > 1"
7,"select distinct business_id from events as e join (select event_type, avg(occurences) as avg_occ from events group by event_type) as tmp on e.event_type = tmp.event_type where e.occurences > tmp.avg_occ group by business_id having count(business_id) > 1"
8,"select distinct e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occur from events group by event_type) as x on e.event_type = x.event_type where e.occurences > x.avg_occur group by e.business_id having count(distinct e.event_type) > 1"
9,"select e.business_id from events as e join (select event_type, avg(occurences) as average from events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.average group by e.business_id having count(e.event_type) > 1"
10,"select e1.business_id from events as e1 left outer join (select event_type, avg(occurences) as avgoc from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avgoc group by e1.business_id having count(distinct e1.event_type) > 1"
11,"select e3.business_id from (select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg_occurences from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occurences) as e3 group by e3.business_id having count(business_id) > 1"
13,"select a.business_id from (select business_id, event_type, occurences, count(event_type) over (partition by business_id) as count_event, avg(occurences) over (partition by event_type) as avg_occurences_event from events) as a where a.occurences > a.avg_occurences_event group by a.business_id having count(distinct a.event_type) > 1"
16,"select a.business_id from events as a join (select event_type, avg(occurences) as avgocc from events group by event_type) as b on (a.event_type = b.event_type and a.occurences > b.avgocc) group by a.business_id having count(a.event_type) > 1"
17,"select a.business_id from events as a left outer join (select distinct event_type, avg(occurences) as avg_occ_by_event from events group by 1) as b on a.event_type = b.event_type where a.occurences > b.avg_occ_by_event group by 1 having count(distinct a.event_type) > 1"
23,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occ from events) as t where t.occurences > t.avg_occ group by business_id having count(event_type) > 1"
37,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg from events) as b where occurences > avg group by business_id having count(event_type) >= 2"
39,"select business_id from events as t1 join (select event_type, avg(occurences) as average from events group by event_type) as t2 on (t1.event_type = t2.event_type and t1.occurences > t2.average) group by business_id having count(business_id) >= 2"
40,"select business_id from events as e join (select event_type, avg(occurences) as avg_occurences from events group by event_type) as t on (e.event_type = t.event_type and e.occurences > t.avg_occurences) group by e.business_id having count(distinct e.event_type) > 1"
42,"select business_id from events as e left outer join (select event_type, avg(occurences) as average_occurences from events group by event_type) as average on e.event_type = average.event_type where occurences > average_occurences group by business_id having count(business_id) > 1"
43,"select business_id from events as evt left outer join (select event_type, avg(occurences) as avg_occ from events group by 1) as avg_evt on evt.event_type = avg_evt.event_type where occurences > avg_occ group by 1 having count(evt.event_type) > 1"
45,"select business_id from events join (select event_type, avg(occurences) as occurence_avg from events group by event_type) as event_avg on events.event_type = event_avg.event_type where events.occurences > event_avg.occurence_avg group by business_id having count(business_id) > 1"
46,"select business_id from events as e join (select event_type, avg(occurences) as avgtimes from events group by event_type) as m on e.event_type = m.event_type where e.occurences > m.avgtimes group by business_id having count(distinct e.event_type) > 1"
52,"select business_id from events as e join (select event_type, avg(occurences) as avg_occurence from events group by event_type) as t on (e.event_type = t.event_type and e.occurences > avg_occurence) group by business_id having count(distinct e.event_type) > 1"
53,"select c.business_id from (select b.business_id, count(b.event_type) as event_count from (select a.business_id, a.event_type from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from events) as a where a.occurences > a.avg_occurences) as b group by b.business_id) as c where c.event_count > 1"
54,"select e.business_id from events as e join (select event_type, avg(occurences) as average from events group by event_type) as e2 on e.event_type = e2.event_type where e.occurences > e2.average group by e.business_id having count(e.event_type) > 1"
56,"select e.business_id from events as e left outer join (select distinct event_type, avg(occurences) as avg_occ from events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by e.business_id having count(distinct e.event_type) > 1"
58,"select e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occ from events group by 1) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by 1 having count(distinct e.event_type) > 1"
60,"select distinct e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occur from events group by event_type) as t1 on e.event_type = t1.event_type where e.occurences > t1.avg_occur group by e.business_id having count(distinct e.event_type) > 1"
61,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from events) as t where occurences > average group by 1 having count(event_type) > 1"
134,"select e.business_id from (select event_type, avg(occurences) as avg_occ from events group by event_type) as t1 left outer join events as e on (t1.event_type = e.event_type and e.occurences > t1.avg_occ) group by e.business_id having count(e.event_type) > 1"
135,"select events.business_id from events left outer join (select event_type, avg(occurences) as average from events group by events.event_type) as t2 on events.event_type = t2.event_type where events.occurences > t2.average group by events.business_id having count(distinct events.event_type) > 1"
138,"select a.business_id from events as a join (select event_type, avg(occurences) as avg_occurence from events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occurence group by a.business_id having count(distinct a.event_type) > 1"
141,"select a.business_id from events as a left outer join (select event_type, avg(occurences) as mean from events group by event_type) as c on a.event_type = c.event_type where a.occurences > c.mean group by a.business_id having count(c.event_type) >= 2"
142,"select a.business_id from events as a left outer join (select avg(occurences) as avg_occ, event_type from events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occ group by business_id having count(business_id) > 1"
151,"select business_id from (select a.business_id, a.event_type, a.occurences, b.event_avg from events as a left outer join (select event_type, avg(occurences) as event_avg from events group by event_type) as b on a.event_type = b.event_type) as temp where occurences > event_avg group by business_id having count(event_type) > 1"
155,"select business_id from (select business_id, avg(occurences) over (partition by event_type) as avg_occ, occurences from events) as e where occurences > avg_occ group by business_id having count(business_id) > 1"
157,"select business_id from (select business_id, count(event_type) as cnt from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from events) as t where occurences > average group by 1) as t where cnt > 1"
159,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurances from events) as asd where occurences > asd.avg_occurances group by business_id having count(event_type) > 1"
160,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from events) as t where occurences > avg_occurences group by 1 having count(event_type) > 1"
162,"select business_id from (select business_id, event_type, sum(occurences) as occ from events group by business_id, event_type) as t1 left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as t2 on t1.event_type = t2.event_type where t1.occ > t2.avg_occ group by business_id having count(t1.event_type) > 1"
163,"select business_id from (select business_id, event_type, occurences, count(event_type) over (partition by business_id) as cnt, avg(occurences) over (partition by event_type) as avgocc from events) as t1 where occurences > avgocc group by 1 having count(business_id) > 1"
164,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avgocc from events) as t1 where occurences > avgocc group by 1 having count(business_id) > 1"
165,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avgocc from events) as t1 where occurences > avgocc group by 1 having count(event_type) > 1"
166,"select business_id from (select event_type, avg(occurences) as avgo from events group by event_type) as tmp join events on tmp.event_type = events.event_type where events.occurences > tmp.avgo group by events.business_id having count(events.event_type) > 1"
178,"select business_id from (select a.business_id, a.event_type from events as a join (select event_type, avg(occurences) as avg_occur from events group by 1) as b on (a.event_type = b.event_type and a.occurences > b.avg_occur)) as temp group by 1 having count(distinct event_type) > 1"
180,"select business_id from (select a.business_id, a.event_type from events as a left outer join (select event_type, avg(occurences) as avg_occur from events group by event_type) as cte on a.event_type = cte.event_type where a.occurences > cte.avg_occur) as cte2 group by business_id having count(event_type) > 1"
188,"select business_id from (select business_id, event_type from (select business_id, event_type, avg(occurences) over (partition by event_type) as event_avg, occurences from events) as t where occurences > event_avg) as tt group by business_id having count(distinct event_type) > 1"
189,"select business_id from (select business_id, event_type from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from events) as a where occurences > average) as a group by business_id having count(event_type) >= 2"
190,"select business_id from (select business_id, event_type, avg(occurences) over (partition by event_type) as avg_event_occur, occurences from events) as sub where occurences > avg_event_occur group by 1 having count(distinct event_type) > 1"
193,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_o from events) as t where occurences > avg_o group by business_id having count(business_id) > 1"
195,"select business_id from (select business_id, occurences, avg(occurences) over (partition by event_type) as avg_occ from events) as a where a.occurences > avg_occ group by business_id having count(business_id) > 1"
196,"select business_id from (select event_type, avg(occurences) as ave_occurences from events group by event_type) as e1 join events as e2 on (e1.event_type = e2.event_type and e2.occurences > e1.ave_occurences) group by business_id having count(distinct e1.event_type) > 1"
197,"select business_id from (select event_type, avg(occurences) as ave_occurences from events group by event_type) as e1 join events as e2 on (e1.event_type = e2.event_type and e2.occurences > e1.ave_occurences) group by business_id having count(distinct e2.event_type) > 1"
198,"select business_id from (select event_type, avg(occurences) as ave_occurences from events as e1 group by event_type) as temp1 join events as e2 on temp1.event_type = e2.event_type where e2.occurences > temp1.ave_occurences group by business_id having count(distinct temp1.event_type) > 1"
200,"select business_id from (select event_type, avg(occurences) as avg_events from events group by event_type) as temp1 join events as temp2 on temp1.event_type = temp2.event_type where temp2.occurences > temp1.avg_events group by business_id having count(distinct temp2.event_type) > 1"
203,"select business_id from events as a join (select event_type, avg(occurences) as avg_occurences from events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occurences group by business_id having count(distinct a.event_type) > 1"
204,"select business_id from events as a join (select event_type, avg(occurences) as event_avg from events group by event_type) as b on a.event_type = b.event_type where a.occurences > event_avg group by a.business_id having count(distinct a.event_type) > 1"
208,"select business_id from events as e join (select event_type, avg(occurences) as occu from events group by event_type) as a on (e.event_type = a.event_type and e.occurences > a.occu) group by business_id having count(e.event_type) >= 2"
212,"select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg group by business_id having count(e1.event_type) > 1"
214,"select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occ group by business_id having count(distinct e1.event_type) > 1"
219,"select business_id from events as a join (select event_type, avg(occurences) as avg_cnt from events group by 1) as b on a.event_type = b.event_type where a.occurences > b.avg_cnt group by 1 having count(a.event_type) > 1"
220,"select business_id from events as a left outer join (select avg(occurences) as avg_occ, event_type from events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avg_occ group by business_id having count(business_id) > 1"
228,"select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occ from events) as temp where occurences > avg_occ group by business_id having count(event_type) > 1"
233,"select c.business_id from (select business_id, a.event_type, b.occurences as occurences, a.occurences as occurences_average from events as b left outer join (select event_type, avg(occurences) as occurences from events group by event_type) as a on b.event_type = a.event_type where b.occurences > a.occurences) as c group by c.business_id having count(c.business_id) > 1"
234,"select c.business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as average from events) as c where c.occurences > c.average group by c.business_id having count(business_id) > 1"
239,"select distinct business_id from events as a join (select event_type, avg(occurences) as avgoccurences from events group by event_type) as b on a.event_type = b.event_type where a.occurences > b.avgoccurences group by business_id having count(distinct a.event_type) > 1"
241,"select distinct e.business_id as business_id from (select event_type, avg(occurences) as avg_occ from events group by event_type) as a join events as e on (a.event_type = e.event_type and a.avg_occ < e.occurences) group by e.business_id having count(distinct e.event_type) > 1"
242,"select distinct e.business_id as business_id from events as e join (select event_type, avg(occurences) as avg_occurences from events group by 1) as avg on e.event_type = avg.event_type where e.occurences > avg.avg_occurences group by 1 having count(e.event_type) > 1"
243,"select distinct e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as x on e.event_type = x.event_type where e.occurences > x.avg_occ group by 1 having count(distinct e.event_type) > 1"
248,"select e.business_id from (select event_type, avg(occurences) as avg_occu from events group by 1) as t join events as e on t.event_type = e.event_type where e.occurences > t.avg_occu group by 1 having count(distinct t.event_type) > 1"
251,"select e.business_id from events as e join (select event_type, avg(occurences) as avo from events group by event_type) as a on e.event_type = a.event_type where e.occurences > a.avo group by e.business_id having count(distinct e.event_type) >= 2"
253,"select e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by e.business_id having count(e.business_id) > 1"
254,"select e1.business_id from (select business_id, event_type, avg(occurences) as e_avg from events group by business_id, event_type) as e1 join (select event_type, avg(occurences) as e_avg from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.e_avg > e2.e_avg group by business_id having count(e1.event_type) > 1"
256,"select e2.business_id from events as e2 join (select e1.event_type, avg(e1.occurences) as avg from events as e1 group by e1.event_type) as temp on e2.event_type = temp.event_type where e2.occurences > temp.avg group by e2.business_id having count(e2.business_id) >= 2"
259,"select t1.business_id from events as t1 join (select event_type, avg(occurences) as mean from events group by event_type) as t2 on t1.event_type = t2.event_type where t1.occurences > t2.mean group by t1.business_id having count(t1.business_id) > 1"
261,"select t2.business_id from (select e.business_id, count(e.event_type) as event_count from (select event_type, avg(occurences) as avg_occ from events group by event_type) as t1 left outer join events as e on (t1.event_type = e.event_type and e.occurences > t1.avg_occ) group by e.business_id) as t2 where t2.event_count > 1"
262,"select t2.business_id from (select e2.business_id, count(e2.event_type) as ev_c from (select event_type, avg(occurences) as ave_occurences from events as e1 group by event_type) as temp1 join events as e2 on temp1.event_type = e2.event_type where e2.occurences > temp1.ave_occurences group by e2.business_id) as t2 where t2.ev_c > 1"
397,"with temp1 as (select event_type, avg(occurences) as average from events group by event_type) select business_id from (select event_type, avg(occurences) as average from events group by event_type) as temp1 join events as e2 on (e2.event_type = temp1.event_type and e2.occurences > temp1.average) group by e2.business_id having count(distinct temp1.event_type) > 1"
